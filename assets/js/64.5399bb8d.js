(window.webpackJsonp=window.webpackJsonp||[]).push([[64],{286:function(t,e){t.exports=function(t){var e={};function r(a){if(e[a])return e[a].exports;var n=e[a]={i:a,l:!1,exports:{}};return t[a].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=t,r.c=e,r.d=function(t,e,a){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(a,n,function(e){return t[e]}.bind(null,n));return a},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s="1c25")}({"1c25":function(t,e,r){"use strict";var a;(r.r(e),"undefined"!=typeof window)&&(r("4141"),(a=window.document.currentScript)&&(a=a.src.match(/(.+\/)[^/]+\.js(\?.*)?$/))&&(r.p=a[1]));function n(t,e,r,a,n,i,s,o){var l,u="function"==typeof t?t.options:t;if(e&&(u.render=e,u.staticRenderFns=r,u._compiled=!0),a&&(u.functional=!0),i&&(u._scopeId="data-v-"+i),s?(l=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),n&&n.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(s)},u._ssrRegister=l):n&&(l=o?function(){n.call(this,this.$root.$options.shadowRoot)}:n),l)if(u.functional){u._injectStyles=l;var c=u.render;u.render=function(t,e){return l.call(e),c(t,e)}}else{var d=u.beforeCreate;u.beforeCreate=d?[].concat(d,l):[l]}return{exports:t,options:u}}var i=n({name:"BarrageMsg",props:{role:{type:Number,default:2},uid:{type:Number,default:0},playingStudentId:{type:Number,default:0},barrageInfo:{type:Object,default:()=>({})},disabledPlayStatus:{type:Boolean,default:!0},barrageScrollStatus:{type:Boolean,default:!0}},data:()=>({}),mounted(){this.barrageInfo.width=this.$refs.barrageMsg.getBoundingClientRect().width},computed:{isPlaying(){return!!this.playingStudentId},styleObject(){const{x:t,sn:e}=this.barrageInfo;return{transform:`translate3d(${t}px, ${e%2*50}px, 0)`}},isOwn(){return this.uid===this.barrageInfo.id}},methods:{handleMouseenter(){1===this.role&&this.barrageScrollStatus&&!this.isPlaying&&this.$emit("changeBarrageScrollStatus",!1)},handleMouseleave(){1!==this.role||this.barrageScrollStatus||this.isPlaying||this.$emit("changeBarrageScrollStatus",!0)},handlePlay(){1!==this.role||this.disabledPlayStatus||(this.$emit("changePlayingStudentId",this.barrageInfo.id),setTimeout(()=>{this.$emit("changePlayingStudentId",0),this.$emit("changeBarrageScrollStatus",!0)},2e3))}}},(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{ref:"barrageMsg",staticClass:"barrage-msg-container",class:{own:t.isOwn},style:t.styleObject,on:{click:t.handlePlay,mouseenter:t.handleMouseenter,mouseleave:t.handleMouseleave}},[r("div",{staticClass:"barrage-msg-con"},[r("div",[t._v(t._s(t.isPlaying)+"-"+t._s(t.barrageInfo.id))])])])}),[],!1,null,null,null).exports,s=n({name:"Barrage",props:{disabledPlayStatus:{type:Boolean,default:!0},barrageMsgStatus:{type:Boolean,default:!1},role:{type:Number,default:2},uid:{type:Number,default:0},playingStudentId:{type:Number,default:0},barrageList:{type:Array,default:()=>[]},barrageScrollStatus:{type:Boolean,default:!0}},data:()=>({barrageListData:[],boxRect:{},timers:[],duration:10,sn:0,currentSn:0}),created(){this.formatBarrageList(this.barrageList)},mounted(){this.boxRect=this.getBoxRect(),this.generatedTimers(this.barrageListData)},components:{BarrageMsg:i},methods:{getBoxRect(){const{width:t,height:e}=this.$refs.stage.getBoundingClientRect();return{width:t,height:e}},runTimers(){const t=e=>{this.timers[e]&&this.timers[e].timer().then(()=>{++this.currentSn,t(++e)})};t(this.currentSn)},generatedTimers(t){const e=[],{width:r}=this.boxRect;t.forEach((t,a)=>{this.timers.includes(t)||(t.sn=this.sn++,t.timer=()=>new Promise((e,a)=>{let n=null,i=!0;const s=a=>{if(t.time&&a===t.time)return!1;t.time=a,t.preTime=t.preTime||t.time;const o=t.time-t.preTime;if(t.preTime=a,t.width&&r&&this.barrageScrollStatus&&this.barrageMsgStatus){const a=100,l=r+t.width+a,u=t.width+a,c=(l/(1e3*this.duration)*o).toFixed(2);if(t.x-=c,i&&(t.x<-l||t.x<-u)&&(i=!1,e(t.x)),t.x<-l)return n&&cancelAnimationFrame(n),!1;n=requestAnimationFrame(s)}else n=requestAnimationFrame(s)};n=requestAnimationFrame(s)}),e.push(t))}),this.timers.splice(this.timers.length,0,...e)},formatBarrageList(t=[]){const e=[];t.forEach(t=>{this.barrageListData.includes(t)||(this.$set(t,"x",0),e.push(t))}),this.barrageListData.splice(this.barrageListData.length,0,...e)},changeBarrageScrollStatus(t){this.$emit("changeBarrageScrollStatus",t)},changePlayingStudentId(t){this.$emit("changePlayingStudentId",t)}},watch:{barrageList(t){this.formatBarrageList(t)},barrageListData(t){this.generatedTimers(t)},timers(){this.barrageMsgStatus&&this.runTimers()},barrageMsgStatus(t){!this.currentSn&&t&&this.runTimers()}}},(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{ref:"stage",staticClass:"barrage-container"},[t.barrageMsgStatus?t._l(t.barrageListData,(function(e){return r("BarrageMsg",{key:e.id,attrs:{barrageInfo:e,role:t.role,uid:t.uid,playingStudentId:t.playingStudentId,barrageScrollStatus:t.barrageScrollStatus,disabledPlayStatus:t.disabledPlayStatus},on:{changeBarrageScrollStatus:t.changeBarrageScrollStatus,changePlayingStudentId:t.changePlayingStudentId}})})):t._e()],2)}),[],!1,null,null,null).exports;s.install=function(t){t.component(s.name,s)};var o=s;e.default=o},4141:function(t,e){!function(t){var e=t.getElementsByTagName("script");"currentScript"in t||Object.defineProperty(t,"currentScript",{get:function(){try{throw new Error}catch(a){var t,r=(/.*at [^\(]*\((.*):.+:.+\)$/gi.exec(a.stack)||[!1])[1];for(t in e)if(e[t].src==r||"interactive"==e[t].readyState)return e[t];return null}}})}(document)}})}}]);